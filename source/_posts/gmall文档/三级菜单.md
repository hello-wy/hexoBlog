title: 三级菜单
author: 远方
tags:
  - LeetCode
  - 算法
categories:
  - LeetCode破局攻略
date: 2016-01-01 19:20:00
---
# 三级菜单

> 主要亮点是：使用了流来处理对象列表，比较的巧妙。

## 编写接口(controller)



## 递归调用获取子菜单

### 思路

使用流处理，不需要关注数据的类型，是一个通用的模版。

1. 获取所有的菜单信息
2. 将菜单信息转化成流，过滤出一级菜单（parent=0）
3. 使用递归的方法找子菜单（prentId=children.parentId）
    1. 过滤出父菜单的所有子菜单（filter）
    2. 对每一个子菜单在做查询子菜单的递归操作
    3. 完成之后进行排序，排序的时候防止空指针异常，使用三元运算。
    4. collect收集结果
4. 同样进行排序
5. 最后collect收集流成一个list返回结果



### 具体实现

在此向操作之前还需要在entity实体类中添加一个属性，children属性存放父标签下子标签。

```java
	@TableField(exist = false)
	private List<CategoryEntity> children;
```

>  这里还使用了一个@tableField注解来声明不需要在数据库中保存。



在这个操作中使用了递归的方法实现了多级菜单的分类以及排序操作。

```java
    @Override
    public List<CategoryEntity> categoryTree() {
//        查询所有菜单,条件为空.
        List<CategoryEntity> entityList = baseMapper.selectList(null);
//        把list转化成流进行操作
        List<CategoryEntity> categoryTree = entityList.stream()
                .filter(item -> item.getParentCid() == 0)       //进行过滤,找到所有一级菜单
                .map(item->{
                    item.setChildren(categoryChildren(entityList, item));       //设置子菜单
                    return item;
                })
                //进行排序菜单1,菜单2 还要进行空指针判断,不能为空
                .sorted((menu1,menu2)-> (menu1.getSort() == null ? 0 : menu1.getSort()) - (menu2.getSort() == null ? 0 : menu2.getSort()))
                .collect(Collectors.toList());          //转化成list类型

        return categoryTree;
    }

    public List<CategoryEntity> categoryChildren(List<CategoryEntity> entityList,CategoryEntity menu){

        List<CategoryEntity> childrenList = entityList.stream()
          //对每一个
                .filter(item-> item.getParentCid() == menu.getCatId())
          
                .map(item->{
                    item.setChildren(categoryChildren(entityList, item));
                    return item;
                })
                .sorted((menu1,menu2)-> (menu1.getSort() == null ? 0 : menu1.getSort()) - (menu2.getSort() == null ? 0 : menu2.getSort()))
                .collect(Collectors.toList());
        return childrenList;
    }
```
